<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>{{ title or "Secret Santa" }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        :root{
            --accent-blue: #38bdf8;
            --accent-red: #ff4d4d;
            --accent-white: #ffffff;
            --card-bg: rgba(15,23,42,0.95);
        }

        html,body{
            margin:0;
            padding:0;
            height:100%;
            font-family: "Nunito", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #1e293b 0, #020617 50%, #000 100%);
            color: #f9fafb;
        }

        /* --- container --- */
        .container{
            max-width:720px;
            margin:40px auto;
            background:var(--card-bg);
            border-radius:18px;
            padding: 48px 28px 22px; /* extra top padding so header is never covered */
            box-shadow:0 24px 60px rgba(0,0,0,0.55);
            border:1px solid rgba(148,163,184,0.18);
            position:relative;
            overflow:hidden;
        }

        h1,h2,h3{ margin-top:0; text-align:center; }

        a{ color:var(--accent-blue); text-decoration:none; }
        a:hover{ color:var(--accent-red); }

        /* --- buttons --- */
        .btn{
            display:inline-block;
            padding:10px 18px;
            border-radius:999px;
            border:none;
            cursor:pointer;
            text-decoration:none;
            font-size:14px;
            font-weight:700;
            transition: transform .1s, box-shadow .15s, filter .1s;
        }

        .btn-primary{
            background: linear-gradient(135deg,#22c55e,#4ade80);
            color:#052e16;
        }

        .btn-secondary{
            background: linear-gradient(135deg, var(--accent-blue), #22d3ee);
            color:#02131f;
            position:relative;
            overflow:hidden;
        }

        /* soft inner red-white glow (the subtle, premium accent you liked) */
        .btn-secondary::after{
            content: "";
            position: absolute;
            inset: 0;
            border-radius: inherit;
            background: radial-gradient(
                circle at 50% 120%,
                rgba(255,255,255,0.62) 0%,
                rgba(255,77,77,0.30) 36%,
                transparent 72%
            );
            opacity: 0.36;
            pointer-events: none;
            mix-blend-mode: screen;
        }

        .btn:hover{
            transform: translateY(-1px) scale(1.01);
            filter: brightness(1.05);
            box-shadow: 0 10px 20px rgba(0,0,0,0.35);
        }

        /* inputs */
        input[type="text"], input[type="password"], textarea{
            width:100%;
            padding:10px 12px;
            border-radius:10px;
            border:1px solid #4b5563;
            background:#020617;
            color:#e5e7eb;
            font-size:14px;
            box-sizing:border-box;
        }
        input:focus, textarea:focus{
            outline:none;
            border-color:var(--accent-blue);
            box-shadow:0 0 6px var(--accent-red);
        }
        textarea{ resize:vertical; min-height:80px; }
        label{ font-size:14px; color:#dbeafe; }
        .field{ margin-bottom:14px; }

        .flash{ padding:8px 10px; border-radius:8px; margin-bottom:12px; font-size:13px; }
        .flash.error{ background:#fee2e2; color:#7f1d1d; }
        .flash.success{ background:#dcfce7; color:#14532d; }
        .flash.info{ background:#e0f2fe; color:#0c4a6e; }

        .footer{ margin-top:18px; font-size:11px; text-align:center; color:#9ca3af; }

        /* --- music control: moved higher so it won't cover header on mobile --- */
        .music-control{
            position:absolute;
            top:8px;          /* moved further up */
            right:10px;
            z-index:800;      /* very high so it sits above lights and content */
        }
        .music-control .btn{ padding:8px 12px; font-size:13px; }

        /* --- snow (kept) --- */
        .snow{
            position:absolute;
            width:4px; height:4px;
            background:white; border-radius:50%;
            opacity:0.8; animation: fall 10s linear infinite;
        }
        .snow:nth-child(1){ left:10%; animation-duration:8s; }
        .snow:nth-child(2){ left:30%; animation-duration:9s; animation-delay:2s; }
        .snow:nth-child(3){ left:50%; animation-duration:7s; animation-delay:4s; }
        .snow:nth-child(4){ left:70%; animation-duration:11s; animation-delay:1s; }
        .snow:nth-child(5){ left:90%; animation-duration:10s; animation-delay:3s; }

        @keyframes fall{
            0%{ transform: translateY(-10px); opacity:0; }
            10%{ opacity:0.95; }
            100%{ transform: translateY(500px); opacity:0; }
        }

        /* --- SVG string lights container --- */
        .svg-lights {
            position:absolute;
            top: -18px; /* slightly above the card border */
            left: 50%;
            transform: translateX(-50%);
            width: 88%;
            max-width:700px;
            height: 64px;
            pointer-events: none;
            z-index:120; /* below music control, above card surface */
        }

        /* svg bulbs glow via CSS (no movement) */
        .svg-lights .svg-bulb {
            filter: drop-shadow(0 6px 12px rgba(0,0,0,0.45));
        }
        .svg-lights .bulb-glow {
            mix-blend-mode: screen;
            opacity:0.28;
        }

        /* responsive tweaks */
        @media (max-width:640px){
            .container{ padding:56px 18px 18px; } /* extra top padding for small screens */
            .music-control{ top:6px; right:8px; }
            .svg-lights{ top:-16px; height:52px; width:94%; }
        }
    </style>
</head>
<body>
<div class="container">

    <!-- SVG STRING LIGHTS (style A: simple curved cable + small bulbs) -->
    <div class="svg-lights" aria-hidden="true">
        <svg viewBox="0 0 1000 160" preserveAspectRatio="xMidYMid meet" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true">
            <!-- cable path (subtle) -->
            <path d="M40 90 C150 48, 350 48, 480 90 S750 132, 960 80" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="3" stroke-linecap="round"/>
            <!-- bulbs: evenly placed circles along curve (small, non-moving) -->
            <!-- positions chosen to sit on/near the path -->
            <g class="svg-bulbs" transform="translate(0,0)">
                <!-- bulb 1 -->
                <g class="svg-bulb" transform="translate(90,72)">
                    <circle cx="0" cy="10" r="8" fill="#ff6b78" />
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#ff6b78" />
                </g>
                <!-- bulb 2 -->
                <g class="svg-bulb" transform="translate(190,58)">
                    <circle cx="0" cy="10" r="8" fill="#8ef48a" />
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#8ef48a" />
                </g>
                <!-- bulb 3 -->
                <g class="svg-bulb" transform="translate(300,56)">
                    <circle cx="0" cy="10" r="8" fill="#ffe08a" />
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#ffe08a" />
                </g>
                <!-- bulb 4 -->
                <g class="svg-bulb" transform="translate(420,78)">
                    <circle cx="0" cy="10" r="8" fill="#8ef0ff" />
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#8ef0ff" />
                </g>
                <!-- bulb 5 -->
                <g class="svg-bulb" transform="translate(520,96)">
                    <circle cx="0" cy="10" r="8" fill="#ffb3e2" />
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#ffb3e2" />
                </g>
                <!-- bulb 6 -->
                <g class="svg-bulb" transform="translate(620,108)">
                    <circle cx="0" cy="10" r="8" fill="#ff6b78" />
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#ff6b78" />
                </g>
                <!-- bulb 7 -->
                <g class="svg-bulb" transform="translate(720,92)">
                    <circle cx="0" cy="10" r="8" fill="#8ef48a" />
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#8ef48a" />
                </g>
                <!-- bulb 8 -->
                <g class="svg-bulb" transform="translate(820,76)">
                    <circle cx="0" cy="10" r="8" fill="#ffe08a" />
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#ffe08a" />
                </g>
                <!-- bulb 9 -->
                <g class="svg-bulb" transform="translate(900,68)">
                    <circle cx="0" cy="10" r="8" fill="#8ef0ff" />
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#8ef0ff" />
                </g>
            </g>
        </svg>
    </div>

    <!-- Snow (kept) -->
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>

    <!-- Music control (moved up) -->
    <div class="music-control">
        <button class="btn btn-secondary" type="button" onclick="toggleMusic()">üéµ Music</button>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, msg in messages %}
          <div class="flash {{ category }}">{{ msg }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}

    <div class="footer">Built with ‚ù§Ô∏è for family Secret Santa</div>
</div>

<!-- audio -->
<audio id="bg-music" loop></audio>

<script>
    const audioEl = document.getElementById("bg-music");
    let musicPlaying = false;
    function toggleMusic(){
        if (!audioEl) return;
        if (musicPlaying){ audioEl.pause(); musicPlaying = false; }
        else { audioEl.play().catch(()=>{}); musicPlaying = true; }
    }

    // small optional JS: keep a few bulbs visibly "lit" (static)
    (function(){
        try{
            const svg = document.querySelector('.svg-lights');
            if (!svg) return;
            // slightly increase opacity of selected bulb glows for a gentle static effect
            const glows = svg.querySelectorAll('.bulb-glow');
            [0,2,4,7].forEach(i => {
                if (glows[i]) glows[i].style.opacity = "0.28";
            });
        }catch(e){}
    })();
</script>

</body>
</html>
