<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>{{ title or "Secret Santa" }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        :root{
            --accent-blue: #38bdf8;
            --accent-red: #ff4d4d;
            --accent-white: #ffffff;
            --card-bg: rgba(15,23,42,0.95);
        }

        /* ---------- Base ---------- */
        body {
            margin: 0;
            padding: 0;
            font-family: "Nunito", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #1e293b 0, #020617 50%, #000 100%);
            color: #f9fafb;
        }
        .container {
            max-width: 720px;
            margin: 40px auto;
            background: var(--card-bg);
            border-radius: 18px;
            padding: 26px 28px 22px;
            box-shadow: 0 24px 60px rgba(0,0,0,0.55);
            border: 1px solid rgba(148,163,184,0.18);
            position: relative;
            overflow: visible;
        }
        h1,h2,h3 { margin:0; text-align:center; }
        a { color: var(--accent-blue); }
        a:hover { color: var(--accent-red); }

        /* ---------- Buttons ---------- */
        .btn {
            display:inline-block;
            padding:10px 18px;
            border-radius:999px;
            border:none;
            cursor:pointer;
            font-weight:700;
            font-size:14px;
            text-decoration:none;
            transition: transform .12s, box-shadow .12s, filter .12s;
        }

        /* Primary CTA: green with a subtle warm red accent glow */
        .btn-primary {
            background: linear-gradient(135deg,#22c55e,#4ade80);
            color:#052e16;
            box-shadow:
                0 6px 16px rgba(34,197,94,0.22),
                0 0 8px rgba(255,77,77,0.05); /* subtle red hint */
            border: 1px solid rgba(0,0,0,0.06);
        }
        .btn-primary:hover {
            transform: translateY(-1px) scale(1.03);
            box-shadow:
                0 10px 28px rgba(34,197,94,0.30),
                0 0 12px rgba(255,77,77,0.08);
        }

        /* Secondary (blue) ‚Äî subtle white top / red bottom trim */
        .btn-secondary {
            background: linear-gradient(135deg,var(--accent-blue),#22d3ee);
            color:#02131f;
            padding-top:9px;
            padding-bottom:9px;
            position:relative;
            overflow: visible;
        }
        .btn-secondary::before,
        .btn-secondary::after {
            content: "";
            position: absolute;
            left: 8px;
            right: 8px;
            height: 3px;
            border-radius: 3px;
            pointer-events: none;
            opacity: 0.92;
        }
        /* thin white top stripe, thin red bottom stripe ‚Äî subtle and classy */
        .btn-secondary::before { top: -5px; background: var(--accent-white); height: 2px; opacity: 0.95; }
        .btn-secondary::after  { bottom: -5px; background: var(--accent-red); height: 2px; opacity: 0.95; }

        .btn-secondary:hover {
            transform: translateY(-1px) scale(1.01);
            filter: brightness(1.02);
        }

        /* ---------- Inputs / forms ---------- */
        input[type="text"], input[type="password"], textarea {
            width:100%; padding:10px 12px; border-radius:10px; border:1px solid #4b5563; background:#020617; color:#e5e7eb; font-size:14px; box-sizing:border-box;
        }
        textarea { min-height:80px; resize:vertical; }
        label { font-size:14px; color:#dbeafe; }
        .field { margin-bottom:14px; }

        /* ---------- Flash ---------- */
        .flash { padding:8px 10px; border-radius:8px; margin-bottom:12px; font-size:13px; }
        .flash.error { background:#fee2e2; color:#7f1d1d; }
        .flash.success { background:#dcfce7; color:#14532d; }
        .flash.info { background:#e0f2fe; color:#0c4a6e; }

        /* ---------- Music control (above decorations) ---------- */
        .music-control { position:absolute; top:16px; right:16px; z-index:1200; }

        /* ---------- Snow (falling) ---------- */
        .snow { position:absolute; width:4px; height:4px; background:white; border-radius:50%; opacity:0.8; animation: fall linear infinite; will-change: transform, opacity; z-index:20; pointer-events:none; }
        .snow.s1 { left:10%; animation-duration:8s; animation-delay:0s; top:-10px; }
        .snow.s2 { left:28%; animation-duration:9.5s; animation-delay:1.2s; top:-12px; }
        .snow.s3 { left:48%; animation-duration:7.6s; animation-delay:0.6s; top:-8px; }
        .snow.s4 { left:70%; animation-duration:11s; animation-delay:2.0s; top:-14px; }
        .snow.s5 { left:88%; animation-duration:10.2s; animation-delay:1.0s; top:-16px; }
        @keyframes fall { 0% { transform: translateY(-10px) scale(0.9); opacity:0; } 10% { opacity:0.9; transform: translateY(30px) scale(1);} 100% { transform: translateY(560px) scale(0.9); opacity:0; } }

        /* ---------- String lights (SVG) ---------- */
        .string-lights-wrap { position:absolute; top:-6px; left:0; right:0; height:88px; pointer-events:none; z-index:800; display:flex; justify-content:center; align-items:flex-start; overflow:visible; }
        .string-lights-svg { width:100%; max-width:760px; height:88px; display:block; margin:0 auto; pointer-events:none; }

        /* bulb glow only ‚Äî no positional movement */
        .bulb-glow { transform-origin:center; opacity:0; filter: blur(8px); mix-blend-mode:screen; transition: opacity .18s ease; }
        .bulb-lit { opacity:1; filter: blur(10px); }

        @keyframes bulb-pulse { 0% { opacity: 0.0; transform: scale(1); } 50% { opacity: 1.0; transform: scale(1.02); } 100% { opacity: 0.0; transform: scale(1); } }
        .glow-anim { animation: bulb-pulse 2200ms ease-in-out infinite; }
        .glow-anim.slow { animation-duration: 3200ms; }
        .glow-anim.fast { animation-duration: 1500ms; }

        /* reduced motion respect */
        @media (prefers-reduced-motion: reduce) {
            .glow-anim { animation: none; opacity: 0.95; }
            .snow { animation: none; }
            .btn-primary, .btn-secondary { transition: none; }
        }

        .content-layer { position:relative; z-index:100; }

        .footer { margin-top:18px; font-size:11px; text-align:center; color:#9ca3af; }

        @media (max-width:640px) {
            .container { margin:20px; padding:20px; }
            .string-lights-svg { max-width:640px; }
        }
    </style>
</head>
<body>
<div class="container">

    <!-- string lights svg (static positions, glow/opacity animate only) -->
    <div class="string-lights-wrap" aria-hidden="true">
        <svg class="string-lights-svg" viewBox="0 0 760 88" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img">
            <path d="M20,36 C120,18 200,18 300,36 C400,54 520,54 640,36 C720,24 740,24 740,24" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="3" stroke-linecap="round" />
            <!-- bulbs -->
            <g transform="translate(40,36)">
                <rect x="-3" y="-18" width="6" height="8" rx="2" fill="#111" opacity="0.7" />
                <circle cx="0" cy="6" r="8" fill="#ff6b78" stroke="rgba(0,0,0,0.18)" stroke-width="1" />
                <circle class="bulb-glow glow-anim slow" cx="0" cy="6" r="18" fill="rgba(255,90,110,0.22)" />
            </g>

            <g transform="translate(110,30)">
                <rect x="-3" y="-18" width="6" height="8" rx="2" fill="#111" opacity="0.7" />
                <circle cx="0" cy="6" r="8" fill="#8ef48a" stroke="rgba(0,0,0,0.18)" stroke-width="1" />
                <circle class="bulb-glow glow-anim" cx="0" cy="6" r="18" fill="rgba(110,230,140,0.22)" />
            </g>

            <g transform="translate(180,36)">
                <rect x="-3" y="-18" width="6" height="8" rx="2" fill="#111" opacity="0.7" />
                <circle cx="0" cy="6" r="8" fill="#ffe08a" stroke="rgba(0,0,0,0.18)" stroke-width="1" />
                <circle class="bulb-glow glow-anim fast" cx="0" cy="6" r="18" fill="rgba(255,215,110,0.22)" />
            </g>

            <g transform="translate(260,30)">
                <rect x="-3" y="-18" width="6" height="8" rx="2" fill="#111" opacity="0.7" />
                <circle cx="0" cy="6" r="8" fill="#8ef0ff" stroke="rgba(0,0,0,0.18)" stroke-width="1" />
                <circle class="bulb-glow glow-anim" cx="0" cy="6" r="18" fill="rgba(110,230,240,0.22)" />
            </g>

            <g transform="translate(340,36)">
                <rect x="-3" y="-18" width="6" height="8" rx="2" fill="#111" opacity="0.7" />
                <circle cx="0" cy="6" r="8" fill="#ffb3e2" stroke="rgba(0,0,0,0.18)" stroke-width="1" />
                <circle class="bulb-glow glow-anim slow" cx="0" cy="6" r="18" fill="rgba(255,160,200,0.22)" />
            </g>

            <g transform="translate(420,30)">
                <rect x="-3" y="-18" width="6" height="8" rx="2" fill="#111" opacity="0.7" />
                <circle cx="0" cy="6" r="8" fill="#ff6b78" stroke="rgba(0,0,0,0.18)" stroke-width="1" />
                <circle class="bulb-glow glow-anim fast" cx="0" cy="6" r="18" fill="rgba(255,90,110,0.22)" />
            </g>

            <g transform="translate(500,36)">
                <rect x="-3" y="-18" width="6" height="8" rx="2" fill="#111" opacity="0.7" />
                <circle cx="0" cy="6" r="8" fill="#8ef48a" stroke="rgba(0,0,0,0.18)" stroke-width="1" />
                <circle class="bulb-glow glow-anim slow" cx="0" cy="6" r="18" fill="rgba(110,230,140,0.22)" />
            </g>

            <g transform="translate(580,30)">
                <rect x="-3" y="-18" width="6" height="8" rx="2" fill="#111" opacity="0.7" />
                <circle cx="0" cy="6" r="8" fill="#ffe08a" stroke="rgba(0,0,0,0.18)" stroke-width="1" />
                <circle class="bulb-glow glow-anim" cx="0" cy="6" r="18" fill="rgba(255,215,110,0.22)" />
            </g>

            <g transform="translate(660,36)">
                <rect x="-3" y="-18" width="6" height="8" rx="2" fill="#111" opacity="0.7" />
                <circle cx="0" cy="6" r="8" fill="#8ef0ff" stroke="rgba(0,0,0,0.18)" stroke-width="1" />
                <circle class="bulb-glow glow-anim slow" cx="0" cy="6" r="18" fill="rgba(110,230,240,0.22)" />
            </g>
        </svg>
    </div>

    <!-- Snow decor -->
    <div class="snow s1" aria-hidden="true"></div>
    <div class="snow s2" aria-hidden="true"></div>
    <div class="snow s3" aria-hidden="true"></div>
    <div class="snow s4" aria-hidden="true"></div>
    <div class="snow s5" aria-hidden="true"></div>

    <!-- Music button (above decorations) -->
    <div class="music-control">
        <button class="btn btn-secondary" type="button" onclick="toggleMusic()">üéµ Music</button>
    </div>

    <!-- content -->
    <div class="content-layer">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, msg in messages %}
              <div class="flash {{ category }}">{{ msg }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}

        <div class="footer">Built with ‚ù§Ô∏è for family Secret Santa</div>
    </div>
</div>

<audio id="bg-music" loop></audio>

<script>
    const audioEl = document.getElementById("bg-music");
    let musicPlaying = false;
    function toggleMusic() {
        if (!audioEl) return;
        if (musicPlaying) { audioEl.pause(); musicPlaying = false; }
        else { audioEl.play().catch(()=>{}); musicPlaying = true; }
    }
</script>

</body>
</html>
