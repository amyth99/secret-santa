<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>{{ title or "Secret Santa" }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        /* ============================
           Palette + base tokens
           ============================ */
        :root{
            --accent-blue: #38bdf8;
            --accent-red: #ff4d4d;
            --accent-white: #ffffff;
            --card-bg: rgba(15,23,42,0.95);
            --stripe-width: 12px; /* candy-cane stripe width (desktop) */
        }

        /* ============================
           Base layout
           ============================ */
        body {
            margin: 0;
            padding: 0;
            font-family: "Nunito", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #1e293b 0, #020617 50%, #000 100%);
            color: #f9fafb;
        }

        .container {
            max-width: 720px;
            margin: 40px auto;
            background: var(--card-bg);
            border-radius: 18px;
            padding: 26px 28px 22px;
            box-shadow: 0 24px 60px rgba(0,0,0,0.55);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(148,163,184,0.18);
        }

        h1, h2, h3 { margin-top: 0; text-align: center; color: #f8fafc; }
        a { color: var(--accent-blue); text-decoration: none; }
        a:hover { color: var(--accent-red); }

        .btn {
            display: inline-block;
            padding: 10px 18px;
            border-radius: 999px;
            border: none;
            cursor: pointer;
            text-decoration: none;
            font-size: 14px;
            font-weight: 700;
            transition: transform .12s, box-shadow .12s, filter .12s;
            box-shadow: 0 8px 18px rgba(2,6,23,0.45);
        }
        .btn-primary { background: linear-gradient(135deg,#22c55e,#4ade80); color:#052e16; }
        .btn-secondary { background: linear-gradient(135deg,var(--accent-blue),#22d3ee); color:#02131f; border-bottom:3px solid var(--accent-red); border-top:3px solid var(--accent-white); }
        .btn:hover { transform: translateY(-1px) scale(1.01); filter: brightness(1.05); }

        input[type="text"], input[type="password"], textarea {
            width: 100%;
            padding: 10px 12px;
            border-radius: 10px;
            border: 1px solid #4b5563;
            background: #020617;
            color: #e5e7eb;
            font-size: 14px;
            box-sizing: border-box;
        }
        textarea { resize: vertical; min-height: 80px; }
        label { font-size: 14px; color: #dbeafe; }
        .field { margin-bottom: 14px; }

        .flash { padding: 8px 10px; border-radius: 8px; margin-bottom: 12px; font-size: 13px; }
        .flash.error { background: #fee2e2; color: #7f1d1d; }
        .flash.success { background: #dcfce7; color: #14532d; }
        .flash.info { background: #e0f2fe; color: #0c4a6e; }

        .music-control { position: absolute; top: 16px; right: 16px; z-index: 1200; } /* keep above decorations */

        .footer { margin-top: 18px; font-size: 11px; text-align: center; color: #9ca3af; }

        /* ============================
           Recommended config:
           - thin candy-cane stripe on left inside .container
           - two corner SVG snowflakes (subtle)
           ============================ */

        /* stripe container (inside .container) */
        .left-candy-stripe {
            position: absolute;
            top: 8px;
            bottom: 8px;
            left: 8px;
            width: var(--stripe-width);
            border-radius: 8px;
            pointer-events: none;
            z-index: 60; /* below interactive controls but above background */
            box-shadow: 0 6px 18px rgba(0,0,0,0.35) inset;
            background: repeating-linear-gradient(
                135deg,
                var(--accent-red) 0 calc(var(--stripe-width) / 2),
                var(--accent-white) calc(var(--stripe-width) / 2) var(--stripe-width)
            );
            opacity: 0.95;
        }

        /* shrink stripe on small screens so it doesn't steal space */
        @media (max-width: 640px) {
            :root { --stripe-width: 8px; }
            .left-candy-stripe { left: 10px; top: 6px; bottom: 6px; border-radius: 6px; }
        }

        /* corner snowflake basics */
        .corner-snowflake {
            position: absolute;
            width: 44px;
            height: 44px;
            pointer-events: none;
            z-index: 70; /* above stripe but below music-control */
            opacity: 0.95;
            filter: drop-shadow(0 6px 12px rgba(0,0,0,0.55));
        }
        .corner-snowflake svg { width: 100%; height: 100%; display:block; }

        .corner-snowflake.top-left  { top: 10px; left: 34px; } /* offset right so stripe not covered */
        .corner-snowflake.top-right { top: 10px; right: 18px; }

        /* subtle pulse for snowflake glow (soft, non-distracting) */
        @keyframes snow-pulse {
            0%   { opacity: 0.88; transform: scale(1); filter: blur(0px); }
            50%  { opacity: 1;    transform: scale(1.03); filter: blur(0.6px); }
            100% { opacity: 0.88; transform: scale(1); filter: blur(0px); }
        }

        .corner-snowflake .flake-shine {
            opacity: 0.9;
            transform-origin: center;
            animation: snow-pulse 2600ms ease-in-out infinite;
        }

        /* Respect user motion preference */
        @media (prefers-reduced-motion: reduce) {
            .corner-snowflake .flake-shine { animation: none; }
        }

        /* smaller on very small screens */
        @media (max-width: 420px) {
            .corner-snowflake { width: 34px; height: 34px; top: 8px; }
            .corner-snowflake.top-left { left: 28px; }
            .corner-snowflake.top-right { right: 8px; }
        }

        /* ensure stripe/snow don't overlap primary content text (give inner padding) */
        .container .content-pad-left {
            padding-left: calc(var(--stripe-width) + 20px);
        }

    </style>
</head>
<body>
<div class="container">

    <!-- thin candy-cane vertical stripe inside the card -->
    <div class="left-candy-stripe" aria-hidden="true"></div>

    <!-- top-left subtle snowflake (SVG) -->
    <div class="corner-snowflake top-left" aria-hidden="true">
        <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true">
            <!-- simple geometric snowflake with a soft shine circle -->
            <g fill="none" stroke="rgba(255,255,255,0.92)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
                <g transform="translate(32,32)">
                    <line x1="0" y1="-16" x2="0" y2="16" />
                    <line x1="-16" y1="0" x2="16" y2="0" />
                    <line x1="-11.3" y1="-11.3" x2="11.3" y2="11.3" />
                    <line x1="-11.3" y1="11.3" x2="11.3" y2="-11.3" />
                    <circle cx="0" cy="0" r="4.6" fill="rgba(255,255,255,0.04)" />
                </g>
            </g>
            <circle class="flake-shine" cx="32" cy="32" r="14" fill="rgba(255,255,255,0.06)"></circle>
        </svg>
    </div>

    <!-- top-right subtle snowflake (SVG) -->
    <div class="corner-snowflake top-right" aria-hidden="true">
        <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true">
            <g fill="none" stroke="rgba(255,255,255,0.92)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
                <g transform="translate(32,32)">
                    <line x1="0" y1="-16" x2="0" y2="16" />
                    <line x1="-16" y1="0" x2="16" y2="0" />
                    <line x1="-11.3" y1="-11.3" x2="11.3" y2="11.3" />
                    <line x1="-11.3" y1="11.3" x2="11.3" y2="-11.3" />
                    <rect x="-2.4" y="-2.4" width="4.8" height="4.8" rx="1.2" fill="rgba(255,255,255,0.02)" />
                </g>
            </g>
            <circle class="flake-shine" cx="32" cy="32" r="12.8" fill="rgba(255,255,255,0.05)"></circle>
        </svg>
    </div>

    <!-- Snow dots (decorative background) -->
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>
    <div class="snow"></div>

    <!-- music control kept above decorations -->
    <div class="music-control">
        <button class="btn btn-secondary" type="button" onclick="toggleMusic()">üéµ Music</button>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, msg in messages %}
          <div class="flash {{ category }}">{{ msg }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <!-- add content-pad-left to main content wrapper where appropriate so text doesn't run into stripe -->
    <div class="content-pad-left">
      {% block content %}{% endblock %}
    </div>

    <div class="footer">Built with ‚ù§Ô∏è for family Secret Santa</div>
</div>

<audio id="bg-music" loop></audio>

<script>
    const audioEl = document.getElementById("bg-music");
    let musicPlaying = false;
    function toggleMusic() {
        if (!audioEl) return;
        if (musicPlaying) { audioEl.pause(); musicPlaying = false; }
        else { audioEl.play().catch(()=>{}); musicPlaying = true; }
    }
</script>
</body>
</html>
