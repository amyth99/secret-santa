<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>{{ title or "Secret Santa" }}</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        :root{
            --accent-blue: #38bdf8;
            --accent-red: #ff4d4d;
            --accent-white: #ffffff;
            --card-bg: rgba(15,23,42,0.95);
        }

        html,body{
            margin:0;
            padding:0;
            height:100%;
            font-family: "Nunito", system-ui, -apple-system;
            background: radial-gradient(circle at top, #1e293b 0, #020617 50%, #000 100%);
            color: #f9fafb;
        }

        .container{
            max-width:720px;
            margin:40px auto;
            background:var(--card-bg);
            border-radius:18px;
            padding: 48px 28px 22px;
            box-shadow:0 24px 60px rgba(0,0,0,0.55);
            border:1px solid rgba(148,163,184,0.18);
            position:relative;
            overflow:hidden;
        }

        h1,h2,h3{ margin-top:0; text-align:center; }

        a{ color:var(--accent-blue); text-decoration:none; }
        a:hover{ color:var(--accent-red); }

        /* BUTTONS */
        .btn{
            display:inline-block;
            padding:10px 18px;
            border-radius:999px;
            border:none;
            cursor:pointer;
            text-decoration:none;
            font-size:14px;
            font-weight:700;
            transition: transform .1s, box-shadow .15s, filter .1s;
        }

        .btn-primary{
            background: linear-gradient(135deg,#22c55e,#4ade80);
            color:#052e16;
        }

        /* Your original red+white soft glow accent */
        .btn-secondary{
            background: linear-gradient(135deg, var(--accent-blue), #22d3ee);
            color:#02131f;
            position:relative;
            overflow:hidden;
        }
        .btn-secondary::after{
            content: "";
            position: absolute;
            inset: 0;
            border-radius: inherit;
            background: radial-gradient(
                circle at 50% 120%,
                rgba(255,255,255,0.62) 0%,
                rgba(255,77,77,0.30) 36%,
                transparent 72%
            );
            opacity: 0.36;
            pointer-events:none;
            mix-blend-mode: screen;
        }

        .btn:hover{
            transform: translateY(-1px) scale(1.01);
            filter: brightness(1.05);
            box-shadow: 0 10px 20px rgba(0,0,0,0.35);
        }

        /* INPUTS */
        input[type="text"], input[type="password"], textarea{
            width:100%;
            padding:10px 12px;
            border-radius:10px;
            border:1px solid #4b5563;
            background:#020617;
            color:#e5e7eb;
            font-size:14px;
            box-sizing:border-box;
        }

        input:focus, textarea:focus{
            outline:none;
            border-color:var(--accent-blue);
            box-shadow:0 0 6px var(--accent-red);
        }

        textarea{ resize:vertical; min-height:80px; }
        label{ font-size:14px; color:#dbeafe; }
        .field{ margin-bottom:14px; }

        .flash{ padding:8px 10px; border-radius:8px; margin-bottom:12px; font-size:13px; }
        .flash.error{ background:#fee2e2; color:#7f1d1d; }
        .flash.success{ background:#dcfce7; color:#14532d; }
        .flash.info{ background:#e0f2fe; color:#0c4a6e; }

        .footer{ margin-top:18px; font-size:11px; text-align:center; color:#9ca3af; }

        /* MUSIC BUTTON */
        .music-control{
            position:absolute;
            top:8px;
            right:10px;
            z-index:800;
        }
        .music-control .btn{ padding:8px 12px; font-size:13px; }

        /* SNOW */
        .snow{
            position:absolute;
            width:4px; height:4px;
            background:white; border-radius:50%;
            opacity:0.8; animation: fall 10s linear infinite;
        }
        .snow:nth-child(1){ left:10%; animation-duration:8s; }
        .snow:nth-child(2){ left:30%; animation-duration:9s; animation-delay:2s; }
        .snow:nth-child(3){ left:50%; animation-duration:7s; animation-delay:4s; }
        .snow:nth-child(4){ left:70%; animation-duration:11s; animation-delay:1s; }
        .snow:nth-child(5){ left:90%; animation-duration:10s; animation-delay:3s; }

        @keyframes fall{
            0%{ transform: translateY(-10px); opacity:0; }
            10%{ opacity:0.95; }
            100%{ transform: translateY(500px); opacity:0; }
        }

        /* SVG LIGHTS CONTAINER */
        .svg-lights {
            position:absolute;
            top:-18px;
            left:50%;
            transform:translateX(-50%);
            width:88%;
            max-width:700px;
            height:64px;
            pointer-events:none;
            z-index:120;
        }

        /* bulb glow */
        .svg-lights .svg-bulb { filter: drop-shadow(0 6px 12px rgba(0,0,0,0.45)); }
        .svg-lights .bulb-glow { mix-blend-mode: screen; opacity:0.20; }

        /* ðŸŒŸ SOFT GLOW ANIMATION ADDED HERE */
        @keyframes bulbSoftGlow {
            0%   { opacity: 0.10; transform: scale(0.95); }
            50%  { opacity: 0.35; transform: scale(1.05); }
            100% { opacity: 0.10; transform: scale(0.98); }
        }

       /* replace your existing .svg-lights .bulb-glow rule with this */
        .svg-lights .bulb-glow {
            /* keep the soft glow animation */
            animation: bulbSoftGlow 2.6s ease-in-out infinite;
            /* IMPORTANT: ensure scale happens around the actual circle center */
            transform-box: fill-box;            /* use SVG geometry for transform origin */
            transform-origin: center center;    /* center of the circle */
            will-change: opacity, transform;    /* performance hint */
            mix-blend-mode: screen;
            opacity: 0.20;
        }

        /* stagger timing for natural twinkle */
        .svg-lights .bulb-glow:nth-child(1){ animation-duration:2.4s; animation-delay:0.2s; }
        .svg-lights .bulb-glow:nth-child(2){ animation-duration:3.2s; animation-delay:0.8s; }
        .svg-lights .bulb-glow:nth-child(3){ animation-duration:2.9s; animation-delay:0.4s; }
        .svg-lights .bulb-glow:nth-child(4){ animation-duration:3.6s; animation-delay:1.0s; }
        .svg-lights .bulb-glow:nth-child(5){ animation-duration:2.8s; animation-delay:0.3s; }
        .svg-lights .bulb-glow:nth-child(6){ animation-duration:3.4s; animation-delay:0.7s; }
        .svg-lights .bulb-glow:nth-child(7){ animation-duration:2.7s; animation-delay:1.1s; }
        .svg-lights .bulb-glow:nth-child(8){ animation-duration:3.1s; animation-delay:0.5s; }
        .svg-lights .bulb-glow:nth-child(9){ animation-duration:2.5s; animation-delay:0.9s; }

        @media(max-width:640px){
            .container{ padding:56px 18px 18px; }
            .music-control{ top:6px; right:8px; }
            .svg-lights{ top:-16px; height:52px; width:94%; }
        }
    </style>
</head>

<body>
<div class="container">

    <!-- SVG LIGHTS -->
    <div class="svg-lights" aria-hidden="true">
        <svg viewBox="0 0 1000 160" preserveAspectRatio="xMidYMid meet" width="100%" height="100%">
            <path d="M40 90 C150 48, 350 48, 480 90 S750 132, 960 80"
                  fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="3" stroke-linecap="round"/>

            <g class="svg-bulbs">
                <g class="svg-bulb" transform="translate(90,72)">
                    <circle cx="0" cy="10" r="8" fill="#ff6b78"/>
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#ff6b78"/>
                </g>

                <g class="svg-bulb" transform="translate(190,58)">
                    <circle cx="0" cy="10" r="8" fill="#8ef48a"/>
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#8ef48a"/>
                </g>

                <g class="svg-bulb" transform="translate(300,56)">
                    <circle cx="0" cy="10" r="8" fill="#ffe08a"/>
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#ffe08a"/>
                </g>

                <g class="svg-bulb" transform="translate(420,78)">
                    <circle cx="0" cy="10" r="8" fill="#8ef0ff"/>
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#8ef0ff"/>
                </g>

                <g class="svg-bulb" transform="translate(520,96)">
                    <circle cx="0" cy="10" r="8" fill="#ffb3e2"/>
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#ffb3e2"/>
                </g>

                <g class="svg-bulb" transform="translate(620,108)">
                    <circle cx="0" cy="10" r="8" fill="#ff6b78"/>
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#ff6b78"/>
                </g>

                <g class="svg-bulb" transform="translate(720,92)">
                    <circle cx="0" cy="10" r="8" fill="#8ef48a"/>
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#8ef48a"/>
                </g>

                <g class="svg-bulb" transform="translate(820,76)">
                    <circle cx="0" cy="10" r="8" fill="#ffe08a"/>
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#ffe08a"/>
                </g>

                <g class="svg-bulb" transform="translate(900,68)">
                    <circle cx="0" cy="10" r="8" fill="#8ef0ff"/>
                    <circle class="bulb-glow" cx="0" cy="10" r="18" fill="#8ef0ff"/>
                </g>
            </g>
        </svg>
    </div>

    <!-- SNOW -->
    <div class="snow"></div><div class="snow"></div><div class="snow"></div><div class="snow"></div><div class="snow"></div>

    <!-- Music Button -->
    <div class="music-control">
        <button class="btn btn-secondary" onclick="toggleMusic()">ðŸŽµ Music</button>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category,msg in messages %}
            <div class="flash {{category}}">{{msg}}</div>
        {% endfor %}
    {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}

    <div class="footer">â›„â›„â›„</div>
</div>

<audio id="bg-music" loop>
    <source src="{{url_for('static', filename='music/Hiroaki TsuTsumi - Silent Night.mp3')}}" type="audio/mpeg">
</audio>

<script>
    const audioEl = document.getElementById("bg-music");
    let musicPlaying = false;

    function toggleMusic(){
        if(musicPlaying){ audioEl.pause(); musicPlaying=false; }
        else { audioEl.play().catch(()=>{}); musicPlaying=true; }
    }
</script>

</body>
</html>
